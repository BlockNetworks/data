export async function encrypt(t,e){if(!t||!e)return"";"string"!=typeof t&&(t=JSON.stringify(t));let r=(new TextEncoder).encode(e);r.length>32&&(r=r.slice(0,32)),r.length<32&&(r=new Uint8Array(Array.from(r).concat(new Array(32-r.length).fill(0))));const n=await window.crypto.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),i=window.crypto.getRandomValues(new Uint8Array(12)),c=await window.crypto.subtle.encrypt({name:"AES-GCM",iv:i},n,(new TextEncoder).encode(t).buffer);return JSON.stringify({data:new Uint8Array(c).toString(),iv:i.toString()})}export async function decrypt(t,e){if(!t||!e)return"";switch(typeof t){case"string":try{t=JSON.parse(t)}catch(t){return""}case"object":break;default:return""}if(void 0===t.data||void 0===t.iv)return"";let r=(new TextEncoder).encode(e);r.length>32&&(r=r.slice(0,32)),r.length<32&&(r=new Uint8Array(Array.from(r).concat(new Array(32-r.length).fill(0))));const n=new Uint8Array(t.iv.split(",")),i=await window.crypto.subtle.importKey("raw",r,{name:"AES-GCM",length:256},!0,["encrypt","decrypt"]),c=await window.crypto.subtle.decrypt({name:"AES-GCM",iv:n},i,new Uint8Array(t.data.split(",")).buffer);return(new TextDecoder).decode(new Uint8Array(c))}const Encryption={encrypt:encrypt,decrypt:decrypt};export default Encryption;
